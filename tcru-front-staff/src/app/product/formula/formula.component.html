<div class="main-container" style=" height:200vh;">
  <h3 class="card-title">สูตรการผลิต</h3>
  <section class="content-header">
    <form [formGroup]=form (ngSubmit)="insertData()">
      <div class="col-sm-4">
        <div class="form-group">
          <input formControlName="product_id" class="form-control"disabled="" [(ngModel)]="product.product_name">
        </div>
      </div>          

      <div class="card card-primary">
        <div class="card-body">
          <div class="row ">
            <div class="col-sm-4">
              
            </div>
            <div class="col-sm-2">
              <label>เลือกประเภทวัตถุดิบ :</label>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <div class="form-group">
                  <select class="form-control" formControlName="id" [(ngModel)]="Materials.name"(change)="getMaterialCategory($event)">
                    <option value="">ประเภทวัตถุดิบ</option>
                    <option *ngFor="let mat of categoryArr" value="{{mat.id}}">{{mat.name}}
                    </option>
                  </select>
                  <div *ngIf="material_name.invalid && (material_name.dirty || material_name.touched)"
                    class="text-error">
                    <div *ngIf="material_name.errors.required">
                      กรุณาเลือกวัตถุดิบ
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
            <br>
          <div class="row ">

            <div class="col-sm-2">
              <label>เลือกวัตถุดิบ :</label>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <div class="form-group">
                  <select class="form-control" formControlName="material_name" [(ngModel)]="formula.material_name">
                    <option value="">เลือกวัตถุดิบ</option>
                    <option *ngFor="let mat of MaterialCategory" value="{{mat.material_name}}">{{mat.material_name}}
                    </option>
                  </select>
                  <div *ngIf="material_name.invalid && (material_name.dirty || material_name.touched)"
                    class="text-error">
                    <div *ngIf="material_name.errors.required">
                      กรุณาเลือกวัตถุดิบ
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-2">
              <label>หน่วยนับ :</label>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <div class="form-group">
                  <select class="form-control" formControlName="unit" [(ngModel)]="formula.unit">
                    <option value="">เลือกวัตถุดิบ</option>
                    <option>ขวด</option>
                    <option>กระสอบ</option>
                    <option>ลิตร</option>
                  </select>
                  <div *ngIf="material_name.invalid && (material_name.dirty || material_name.touched)"
                    class="text-error">
                    <div *ngIf="material_name.errors.required">
                      กรุณาเลือกวัตถุดิบ
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-sm-2">
              <label>จำนวน :</label>
            </div>
            <div class="col-sm-2">
              <div class="form-group">
                <input type="number" class="form-control" formControlName="quantity" [(ngModel)]="formula.quantity">
                <div *ngIf="quantity.invalid && (quantity.dirty || quantity.touched)" class="text-error">
                  <div *ngIf="quantity.errors.required">
                    กรุณากรอกจำนวนที่ใช้
                  </div>
                </div>
              </div>
            </div>
            <td>
              &nbsp;&nbsp;<button class="btn btn-success ">ยืนยัน</button>
            </td>
          </div>
        </div>
      </div>
    </form>
  </section>
  <br>

  <section class="content-header">
    <div class="card card-success">
      <div class="card-body p-0">
        <div class="card-header">
          <div class="col-sm-12">
            <label>สูตรการผลิต</label>
          </div>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th></th>
              <th>ลำดับ</th>
              <th>วัตถุดิบ</th>
              <th>จำนวน</th>
              <th>หน่วยนับ</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let mat of formula1 ;let i=index ">
              <td></td>
              <td>{{i+1}}</td>
              <td>{{mat.material_name}}</td>
              <td>{{mat.quantity}}</td>
              <td>{{mat.unit}}</td>
              <td >
                <div class="btn-group btn-group-sm">
                  <a  (click)="deleteFormula(mat.id)">
                    <mat-icon>delete_sweep</mat-icon>
                  </a>
                </div>
              </td>
              
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <br>
      <div class="row">
    <div class="form-group">
      <td>
        &nbsp; &nbsp;<button class="btn btn-secondary  " routerLink="/showp"> กลับ</button>
      </td>
    </div>
  </div>
  </section>
</div>